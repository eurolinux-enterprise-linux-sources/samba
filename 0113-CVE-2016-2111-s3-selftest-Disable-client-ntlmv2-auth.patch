From 200965ec47a9cb975194b1b2b6c76d3bdcd8a973 Mon Sep 17 00:00:00 2001
From: Andreas Schneider <asn@samba.org>
Date: Mon, 4 Apr 2016 16:44:39 +0200
Subject: [PATCH 113/321] CVE-2016-2111: s3:selftest: Disable client ntlmv2
 auth for secserver

The client connects with ntlmv1 to the secserver (server with
security = share). So the secserver needs to allow to connect with
NTLMv1 to the password server to verify the user or it will fail.

BUG: https://bugzilla.samba.org/show_bug.cgi?id=11749

Signed-off-by: Andreas Schneider <asn@samba.org>
---
 selftest/target/Samba3.pm | 1 +
 1 file changed, 1 insertion(+)

diff --git a/selftest/target/Samba3.pm b/selftest/target/Samba3.pm
index ee3696e6ba6..7326b22859c 100644
--- a/selftest/target/Samba3.pm
+++ b/selftest/target/Samba3.pm
@@ -231,6 +231,7 @@ sub setup_secserver($$$)
 	my $secserver_options = "
 	security = server
         password server = $s3dcvars->{SERVER_IP}
+	client ntlmv2 auth = no
 ";
 
 	my $ret = $self->provision($prefix,
-- 
2.14.3

